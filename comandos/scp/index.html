<!doctype html><html lang=en-us>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>Scp - My Documentation</title>
<meta name=description content>
<meta name=generator content="Hugo 0.91.2">
<link href=https://wiki.cyd4r.com/index.xml rel=alternate type=application/rss+xml>
<link rel=canonical href=https://wiki.cyd4r.com/comandos/scp/>
<link rel=stylesheet href=https://wiki.cyd4r.com/css/theme.min.css>
<script src=https://use.fontawesome.com/releases/v5.0.6/js/all.js></script>
<link rel=stylesheet href=https://wiki.cyd4r.com/css/chroma.min.css>
<script src=https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js></script>
<script src=https://wiki.cyd4r.com/js/bundle.js></script><style>:root{--custom-font-color:#00ff00;--custom-background-color:black}</style>
<meta property="og:title" content="Scp">
<meta property="og:description" content="Todos utilizamos de forma asidua el comando scp (Secure Copy) en Linux y Unix para transferir archivos entre hosts a través del protocolo SSH. Normalmente nos ceñimos a su utilización básica pero viene bien conocer algunos trucos o usos poco habituales del comando (para algunos) para mejorar u optimizar su utilización. Ahí van unos cuantos ejemplos que espero os sean de utilidad.
Uso básico de SCP Comencemos por lo básico, transferencia de un archivo entre el host local y un host remoto o viceversa y entre hosts remotos.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://wiki.cyd4r.com/comandos/scp/"><meta property="og:image" content="https://wiki.cyd4r.com/images/og-image.png"><meta property="article:section" content="Comandos">
<meta property="article:published_time" content="2021-12-08T19:56:14+01:00">
<meta property="article:modified_time" content="2021-12-08T19:56:14+01:00">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://wiki.cyd4r.com/images/og-image.png">
<meta name=twitter:title content="Scp">
<meta name=twitter:description content="Todos utilizamos de forma asidua el comando scp (Secure Copy) en Linux y Unix para transferir archivos entre hosts a través del protocolo SSH. Normalmente nos ceñimos a su utilización básica pero viene bien conocer algunos trucos o usos poco habituales del comando (para algunos) para mejorar u optimizar su utilización. Ahí van unos cuantos ejemplos que espero os sean de utilidad.
Uso básico de SCP Comencemos por lo básico, transferencia de un archivo entre el host local y un host remoto o viceversa y entre hosts remotos.">
<meta itemprop=name content="Scp">
<meta itemprop=description content="Todos utilizamos de forma asidua el comando scp (Secure Copy) en Linux y Unix para transferir archivos entre hosts a través del protocolo SSH. Normalmente nos ceñimos a su utilización básica pero viene bien conocer algunos trucos o usos poco habituales del comando (para algunos) para mejorar u optimizar su utilización. Ahí van unos cuantos ejemplos que espero os sean de utilidad.
Uso básico de SCP Comencemos por lo básico, transferencia de un archivo entre el host local y un host remoto o viceversa y entre hosts remotos."><meta itemprop=datePublished content="2021-12-08T19:56:14+01:00">
<meta itemprop=dateModified content="2021-12-08T19:56:14+01:00">
<meta itemprop=wordCount content="923"><meta itemprop=image content="https://wiki.cyd4r.com/images/og-image.png">
<meta itemprop=keywords content></head>
<body><div class=container><header>
<h1>My Documentation</h1>
</header>
<div class=content-container>
<main><h1>Scp</h1>
<p>Todos utilizamos de forma asidua el comando scp (Secure Copy) en Linux y Unix para transferir archivos entre hosts a través del protocolo SSH. Normalmente nos ceñimos a su utilización básica pero viene bien conocer algunos trucos o usos poco habituales del comando (para algunos) para mejorar u optimizar su utilización. Ahí van unos cuantos ejemplos que espero os sean de utilidad.</p>
<h2 id=uso-básico-de-scp>Uso básico de SCP</h2>
<p>Comencemos por lo básico, transferencia de un archivo entre el host local y un host remoto o viceversa y entre hosts remotos.</p>
<p><strong>Transferencia de un archivo de local a un host remoto:</strong></p>
<ul>
<li>Archivo local: archivo.tar.gz</li>
<li>Usuario remoto: foo</li>
<li>Host remoto: 192.168.1.100</li>
<li>Ruta remota donde enviar el archivo: /home/foo</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>scp archivo.tar.gz foo@192.168.1.100:/home/foo/
</code></pre></div><p><strong>Transferencia de un archivo de un host remoto a local:</strong></p>
<ul>
<li>Archivo remoto: archivo.tar.gz</li>
<li>Usuario remoto: foo</li>
<li>Host remoto: 192.168.1.100</li>
<li>Ruta local donde guardar el archivo: /home/bar/</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>scp foo@192.168.1.100:/home/foo/archivo.tar.gz /home/bar/
</code></pre></div><p><strong>Transferencia de archivos entre dos hosts remotos:</strong></p>
<ul>
<li>Host remoto #1: 192.168.1.100</li>
<li>Archivo remoto en #1: archivo.tar.gz</li>
<li>Usuario remoto #1: foo</li>
<li>Host remoto #2: 192.168.1.200</li>
<li>Ruta remota de #2 donde guardar el archivo: /home/bar/</li>
<li>Usuario remoto #2: bar</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>scp foo@192.168.1.100:/home/foo/archivo.tar.gz bar@192.168.1.200:/home/bar/
</code></pre></div><p><strong>Copia recursiva y con wildcards (*)</strong></p>
<p>Aunque no suele ser lo más habitual usar scp para realizar copias recursivas o de grandes cantidades de archivos (para eso solemos usar rsync en combinación con ssh), conviene saber que es posible hacerlo.</p>
<p>Para copiar recursivamente archivos y directorios utilizamos el parámetro «-r». El siguiente ejemplo muestra como copiar todo el contenido (archivos y directorios) de la ruta local «/home» a la ruta remota «/var/tmp». En la slida estándar van apareciendo los archivos (los directorios no aparecen) transferidos:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>scp -r /home/ foo@192.168.1.100:/var/tmp
foo@192.168.1.100 password:
VBoxSVC.log.1 100% <span style=color:#ae81ff>2460</span> 2.4KB/s 00:00
VirtualBox.xml 100% <span style=color:#ae81ff>2793</span> 2.7KB/s 00:00
VBoxSVC.log.3 100% <span style=color:#ae81ff>3395</span> 3.3KB/s 00:00
solaris.xml 100% <span style=color:#ae81ff>3573</span> 3.5KB/s 00:00
CentOS6.xml 100% <span style=color:#ae81ff>3674</span> 3.6KB/s 00:00
</code></pre></div><p>Si en lugar de copia recursiva lo que queremos es utilizar wildcards (*) podemos hacerlo como si un «cp» u otro comando estándar se tratara. En el siguiente ejemplo copiamos todos los archivos de /home/foo pero sin recursividad de directorios:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>scp /home/foo/* bar@192.168.1.100:/tmp
</code></pre></div><p>Podemos especificar extension de archivos o patrones para filtrar:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>scp /home/foo/*.log bar@192.168.1.100:/tmp
</code></pre></div><p><strong>Limitar velocidad de SCP</strong></p>
<p>Para limitar el ancho de banda utilizado durante la transferencia de datos con scp se utiliza el parámetro «-l» seguido del máximo de Kbit/s a utilizar durante la copia.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash> scp -l <span style=color:#ae81ff>500</span> archivo.tar.gz foo@192.168.1.100:/tmp
</code></pre></div><p><strong>Habilitar compresión al tráfico de SCP</strong></p>
<p>El parámetro -C activa la compresión en la transferencia de datos vía sc. Si al utilizarlo activamos también el debug ampliaremos la información por salida estándar con los ratios de compresión aplicados entre otras estadísticas:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>scp -Cv archivo.tar.gz foo@192.168.1.100:/home/foo/

<span style=color:#f92672>[</span>...<span style=color:#f92672>]</span>
Transferred: sent 86744, received <span style=color:#ae81ff>1696</span> bytes, in 7.0 seconds
Bytes per second: sent 12471.8, received 243.8
debug1: Exit status <span style=color:#ae81ff>0</span>
debug1: compress outgoing: raw data 93447, compressed 84606, factor 0.91
debug1: compress incoming: raw data 148, compressed 116, factor 0.78
</code></pre></div><p><strong>Mantener stats de archivos (atime, mtime, permisos)</strong>
Al igual que cuando copiamos con el comando «cp», el parámetro «-p» mantendrá los datos de fecha de modificación, fecha de acceso y modos del fichero original:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>scp -p archivo.tar.gz bar@192.168.1.100:/tmp
</code></pre></div><p>Ejemplo de stats:</p>
<p>$ stat archivo.tar.gz
File: `archivo.tar.gz'
Size: 93178 Blocks: 184 IO Block: 4096 regular file
Device: 805h/2053d Inode: 550538 Links: 1
Access: (0644/-rw-r&ndash;r&ndash;) Uid: ( 1000/ alex) Gid: ( 1000/ alex)
Access: 2014-09-20 09:10:14.590601162 +0200
Modify: 2014-09-20 09:10:31.210683568 +0200
Change: 2014-09-20 09:10:31.210683568 +0200
Birth: -
Cambiar el cifrado a utilizar para la transferencia de datos
No suele ser muy habitual, pero si por algún casual necesitas cambiar el tipo de cifrado a utilizar durante la transferencia de archivos por scp, puedes hacerlo con el parámetro «-c». Algunos métodos de cifrado disponibles (protocol version 2) son «3des-cbc», «aes128-cbc», «aes192-cbc», «aes256-cbc», «aes128-ctr», «aes192-ctr», «aes256-ctr», «arcfour128», «arcfour256», «arcfour», «blowfish-cbc, y «cast128-cbc».</p>
<p>$ scp -c aes128-ctr archivo.tar.gz <a href=mailto:bar@192.168.1.100>bar@192.168.1.100</a>:/tmp
Verbose y Quiet Mode
Habrá ocasiones en las que queramos visualizar la mayor información posible de las conexiones scp/ssh y la transferencia de archivos y otras en las que no queramos nada de salida estándar.</p>
<p>Para ampliar la información lo hacemos igual que con ssh, con el parámetro «-v». Básicamente tendremos información en modo debug de la conexión, autenticación y configuración.</p>
<p>$ scp -v archivo.tar.gz <a href=mailto:foo@192.168.1.100>foo@192.168.1.100</a>:/home/foo
Executing: program /usr/bin/ssh host 192.168.1.100, user foo, command scp -v -t &ndash; /home/foo
OpenSSH_5.9p1 Debian-5ubuntu1.4, OpenSSL 1.0.1 14 Mar 2012
debug1: Reading configuration data /etc/ssh/ssh_config
debug1: /etc/ssh/ssh_config line 19: Applying options for *
debug1: Connecting to 192.168.1.100 [192.168.1.100] port 22.
debug1: Connection established.
debug1: identity file /home/alex/.ssh/id_rsa type 1
debug1: Checking blacklist file /usr/share/ssh/blacklist.RSA-2048
[&mldr;]
Y si lo que queremos es deshabilitar toda la salida estándar, utilizaremos la opción «-q», que deshabilitará tanto la barra de progreso como cualquier aviso o mensaje de diagnóstico.</p>
<p>$ scp -q archivo.tar.gz <a href=mailto:foo@192.168.1.100>foo@192.168.1.100</a>:/home/foo
Cambiar el puerto de conexión
Esta es fácil. Si SSH está corriendo en un puerto distinto al TCP 22 deberemos cambiarlo también al utilizar SCP. Para ello utilizamos el parámetro «-P» seguido del puerto:</p>
<p>$ scp -P 6922 archivo.tar.gz <a href=mailto:foo@192.168.1.100>foo@192.168.1.100</a>:/home/foo
Utilizar un fichero de configuración de cliente ssh distinto (ssh_config)
Podemos realizar configuraciones personalizadas para SSH y SCP en un fichero de configuración alternativo e invocarlo desde línea de comandos al ejecutar SCP, de este modo nos ahorramos tener que añadir múltiples parámetros que pueden ser configurados en el archivo de configuración. Especificamos el path a ssh_config con el parámetro «-F»:</p>
<p>$ scp -F /home/alex/ssh_config_SCP archivo.tar.gz <a href=mailto:foo@192.168.1.100>foo@192.168.1.100</a>:/tmp</p>
<p>Executing: program /usr/bin/ssh host &mldr;
OpenSSH_5.9p1 Debian-5ubuntu1.4, OpenSSL 1.0.1 14 Mar 2012
debug1: Reading configuration data /home/alex/ssh_config_SCP
debug1: /home/alex/ssh_config_SCP line 19: Applying options for *
[&mldr;]</p>
<div class=edit-meta>
Last updated on 8 Dec 2021
<br>
Published on 8 Dec 2021
<br></div><nav class=pagination><a class="nav nav-prev" href=https://wiki.cyd4r.com/comandos/ title=Comandos><i class="fas fa-arrow-left" aria-hidden=true></i>&nbsp;Prev - Comandos</a>
<a class="nav nav-next" href=https://wiki.cyd4r.com/comandos/openssl/ title=OpenSSL>Next - OpenSSL <i class="fas fa-arrow-right" aria-hidden=true></i></a>
</nav><footer><p class=powered>Powered by <a href=https://gohugo.io>Hugo</a>. Theme by <a href=https://themes.gohugo.io/hugo-theme-techdoc/>TechDoc</a>. Designed by <a href=https://github.com/thingsym/hugo-theme-techdoc>Thingsym</a>.</p>
</footer>
</main>
<div class=sidebar>
<nav class=slide-menu>
<ul>
<li><a href=https://wiki.cyd4r.com>Home</a></li>
<li class=has-sub-menu><a href=https://wiki.cyd4r.com/vpn/>VPNs<span class="mark closed">+</span></a>
<ul class=sub-menu>
<li><a href=https://wiki.cyd4r.com/vpn/openvpn/>Openvpn</a></li>
<li><a href=https://wiki.cyd4r.com/vpn/wireguard/>Wireguard</a></li>
</ul>
</li>
<li class="parent has-sub-menu"><a href=https://wiki.cyd4r.com/comandos/>Comandos<span class="mark opened">-</span></a>
<ul class=sub-menu>
<li class=active><a href=https://wiki.cyd4r.com/comandos/scp/>Scp</a></li>
<li><a href=https://wiki.cyd4r.com/comandos/openssl/>OpenSSL</a></li>
<li><a href=https://wiki.cyd4r.com/comandos/sed/>Uso del comando sed con ejemplos</a></li>
</ul>
</li>
<li class=has-sub-menu><a href=https://wiki.cyd4r.com/scripts/>Scripts<span class="mark closed">+</span></a>
<ul class=sub-menu>
<li><a href=https://wiki.cyd4r.com/scripts/better_bash_scripting/>Better Bash Scripting</a></li>
<li><a href=https://wiki.cyd4r.com/scripts/monitorizar-red-bash/>Monitorizar Red Bash</a></li>
</ul>
</li>
<li class=has-sub-menu><a href=https://wiki.cyd4r.com/ssh/>SshSshes<span class="mark closed">+</span></a>
<ul class=sub-menu>
<li><a href=https://wiki.cyd4r.com/ssh/ssh-agent-macos/>Ssh Agent Macos</a></li>
</ul>
</li>
<li class=has-sub-menu><a href=https://wiki.cyd4r.com/docker/>Dockers<span class="mark closed">+</span></a>
<ul class=sub-menu>
<li><a href=https://wiki.cyd4r.com/docker/basics-docker/>Basics Docker</a></li>
<li><a href=https://wiki.cyd4r.com/docker/tips/>Tips para Docker</a></li>
</ul>
</li>
<li class=has-sub-menu><a href=https://wiki.cyd4r.com/git/>Gits<span class="mark closed">+</span></a>
<ul class=sub-menu>
<li><a href=https://wiki.cyd4r.com/git/comandos/>Comandos</a></li>
</ul>
</li>
<li class=has-sub-menu><a href=https://wiki.cyd4r.com/dns/>Dns<span class="mark closed">+</span></a>
<ul class=sub-menu>
<li><a href=https://wiki.cyd4r.com/dns/tiposdns/>Tipos de Registros</a></li>
</ul>
</li>
</ul>
</nav>
<div class=sidebar-footer></div>
</div>
</div>
</div>
</body>
</html>